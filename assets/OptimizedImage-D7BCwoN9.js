import{r as a,j as n,m as U}from"./react-vendor-CeN1yosF.js";const W={cloudName:"hirosuwa"};function g(e,h={}){const o=encodeURIComponent(e),{width:l,height:c,quality:r="auto",format:u="auto",crop:m="fill",dpr:i="auto",flags:d=["progressive"]}=h,t=[];l&&t.push(`w_${l}`),c&&t.push(`h_${c}`),t.push(`c_${m}`),t.push(`q_${r}`),t.push(`f_${u}`),t.push(`dpr_${i}`),d.length>0&&t.push(`fl_${d.join(".")}`);const f=t.join(",");return`https://res.cloudinary.com/${W.cloudName}/image/fetch/${f}/${o}`}function V({src:e,alt:h,width:o,height:l,className:c="",priority:r=!1,quality:u="auto",objectFit:m="cover",aspectRatio:i,onLoad:d,style:t}){const[f,v]=a.useState(!1),[$,w]=a.useState(r),[j,b]=a.useState(!1),p=a.useRef(null),x=a.useRef(null);a.useEffect(()=>{if(r||!x.current)return;const s=new IntersectionObserver(O=>{O.forEach(R=>{R.isIntersecting&&(w(!0),s.disconnect())})},{rootMargin:"50px"});return s.observe(x.current),()=>s.disconnect()},[r]);const y=e.startsWith("http")?g(e,{width:o,height:l,quality:u}):e,S=e.startsWith("http")?g(e,{width:20,quality:10}):e,{srcSet:E,sizes:I}=e.startsWith("http")&&o?{srcSet:[320,640,768,1024,1280,1920].filter(s=>!o||s<=o*2).map(s=>`${g(e,{width:s,quality:u})} ${s}w`).join(", "),sizes:"(max-width: 640px) 100vw, (max-width: 768px) 90vw, (max-width: 1024px) 80vw, 1280px"}:{srcSet:void 0,sizes:void 0},N=()=>{v(!0),d?.()},z=()=>{b(!0),p.current&&(p.current.src=e)},_={...t,...i&&{position:"relative",paddingBottom:`${1/parseFloat(i)*100}%`,height:0,overflow:"hidden"}},L={objectFit:m,...i&&{position:"absolute",top:0,left:0,width:"100%",height:"100%"}};return n.jsxs("div",{ref:x,className:`relative overflow-hidden ${c}`,style:_,children:[!f&&n.jsxs("div",{className:"absolute inset-0",children:[n.jsx("img",{src:S,alt:"",className:"w-full h-full object-cover filter blur-xl",style:{filter:"blur(20px)"}}),n.jsx("div",{className:"absolute inset-0 bg-gray-200/50 animate-pulse"})]}),$&&n.jsx(U.img,{ref:p,src:y,srcSet:E,sizes:I,alt:h,width:o,height:l,loading:r?"eager":"lazy",decoding:"async",onLoad:N,onError:z,className:`${i?"":"w-full h-full"} ${c}`,style:L,initial:{opacity:0},animate:{opacity:f?1:0},transition:{duration:.3}}),j&&n.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200",children:n.jsx("span",{className:"text-gray-500 text-sm",children:"画像を読み込めませんでした"})})]})}export{V as O};
